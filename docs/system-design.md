# システム設計書：Human in the Loop ブログサイト

## 1. システム概要

### 1.1 アーキテクチャ概要
- **アーキテクチャパターン**：JAMstack（JavaScript, APIs, Markup）
- **デプロイメント**：静的サイト生成 + CDN配信
- **データフロー**：クライアントサイドでの動的処理

### 1.2 システム構成図
```
[ユーザー] 
    ↓
[Vercel CDN] 
    ↓
[静的サイト]
    ├── HTML/CSS/JS
    ├── Markdownファイル
    └── 画像・リソース
```

## 2. 技術選定

### 2.1 フロントエンド技術
- **HTML5**
  - セマンティックマークアップ
  - アクセシビリティ対応
  - SEO最適化

- **CSS3**
  - フレックスボックス・グリッドレイアウト
  - レスポンシブデザイン
  - CSSカスタムプロパティ（CSS変数）

- **JavaScript (ES6+)**
  - ES6クラス構文
  - アロー関数
  - 分割代入・テンプレートリテラル

### 2.2 開発・運用技術
- **バージョン管理**：Git + GitHub
- **デプロイメント**：Vercel
- **開発環境**：Claude Code
- **静的サーバー**：Python http.server / npx serve

## 3. ディレクトリ構成

```
/
├── docs/                    # ドキュメント
│   ├── requirements.md
│   ├── system-design.md
│   └── technical-specs.md
├── posts/                   # 記事データ
│   ├── posts.json
│   └── *.md
├── demos/                   # デモアプリ
│   └── calculator/
├── index.html              # メインページ
├── *.html                  # 個別記事ページ
├── styles.css              # スタイルシート
├── script.js               # JavaScript
├── vercel.json             # Vercel設定
├── .gitignore              # Git無視設定
└── README.md               # プロジェクト説明
```

## 4. データ設計

### 4.1 記事データ構造
```json
{
  "posts": [
    {
      "id": "unique-id",
      "title": "記事タイトル",
      "description": "記事の概要",
      "date": "2024-01-09",
      "tags": ["タグ1", "タグ2"],
      "category": "カテゴリー",
      "filename": "記事ファイル名.md",
      "url": "記事URL.html",
      "likes": 12,
      "comments": 3
    }
  ]
}
```

### 4.2 Markdownファイル構造
```markdown
# 記事タイトル

## 概要
記事の概要・導入

## 本文
記事の詳細内容

## まとめ
記事のまとめ・今後の展望
```

## 5. 機能設計

### 5.1 記事表示機能
- **記事一覧表示**
  - `posts.json`からメタデータを読み込み
  - 記事カードの動的生成
  - 日付順ソート

- **個別記事表示**
  - 静的HTMLファイル
  - 共通ヘッダー・フッター
  - ナビゲーション機能

### 5.2 検索・フィルタリング機能
- **全文検索**
  - タイトル・概要・タグでの検索
  - リアルタイム検索（keyup イベント）
  - 検索結果のハイライト

- **タグフィルタリング**
  - タグクリックでの絞り込み
  - 複数タグの組み合わせ検索
  - フィルタリング結果の表示・非表示

### 5.3 インタラクティブ機能
- **いいね機能**
  - ローカルストレージでの状態保存
  - アニメーション効果
  - カウント表示

- **お問い合わせフォーム**
  - バリデーション
  - 送信確認
  - 成功メッセージ表示

## 6. UI/UX設計

### 6.1 レイアウト設計
- **2カラムレイアウト**
  - メインコンテンツ（70%）
  - サイドバー（30%）
  - モバイルでは1カラムに変更

- **レスポンシブブレークポイント**
  - デスクトップ：1024px以上
  - タブレット：768px-1023px
  - スマートフォン：767px以下

### 6.2 デザインシステム
- **カラーパレット**
  - プライマリー：#2c3e50
  - セカンダリー：#3498db
  - アクセント：#e74c3c
  - 背景：#f8f9fa

- **タイポグラフィ**
  - フォント：システムフォント
  - 見出し：1.5rem - 2rem
  - 本文：1rem
  - 行間：1.6

## 7. パフォーマンス設計

### 7.1 最適化戦略
- **静的サイト生成**
  - サーバーサイド処理の削減
  - 高速なページ読み込み
  - CDN配信による高速化

- **リソース最適化**
  - CSS/JSの最小化
  - 画像の適切な圧縮
  - 不要なリクエストの削減

### 7.2 キャッシュ戦略
- **ブラウザキャッシュ**
  - 静的リソースの長期キャッシュ
  - HTMLファイルの適切なキャッシュ設定

- **CDNキャッシュ**
  - Vercelの自動キャッシュ最適化
  - エッジロケーションでの配信

## 8. セキュリティ設計

### 8.1 セキュリティ対策
- **XSS対策**
  - ユーザー入力のサニタイズ
  - CSP (Content Security Policy) 設定
  - HTMLエスケープ処理

- **HTTPS強制**
  - Vercelの自動HTTPS設定
  - HTTP→HTTPSリダイレクト
  - SSL証明書の自動更新

### 8.2 セキュリティヘッダー
```json
{
  "headers": [
    {
      "key": "X-Frame-Options",
      "value": "DENY"
    },
    {
      "key": "X-Content-Type-Options",
      "value": "nosniff"
    }
  ]
}
```

## 9. 運用設計

### 9.1 デプロイメント設計
- **継続的デプロイ**
  - GitHub push → Vercel自動デプロイ
  - プレビュー環境での事前確認
  - 本番環境への自動反映

- **ロールバック戦略**
  - Gitによるバージョン管理
  - Vercelのデプロイ履歴
  - 簡単なロールバック機能

### 9.2 監視・ログ設計
- **パフォーマンス監視**
  - Vercelの標準監視
  - ページ読み込み時間の追跡
  - エラーログの監視

- **アクセス解析**
  - 将来的なGoogle Analytics導入
  - ユーザー行動の分析
  - 人気記事の把握

## 10. 拡張性設計

### 10.1 API連携準備
- **RESTful API設計**
  - `/api/posts` - 記事データ取得
  - `/api/posts/:id` - 個別記事取得
  - `/api/contact` - お問い合わせ送信

- **データベース連携**
  - 将来的なPostgreSQL / MongoDB導入
  - 記事データの動的管理
  - ユーザー管理機能

### 10.2 機能拡張計画
- **コメント機能**
  - 記事へのコメント投稿
  - コメント管理機能
  - スパム対策

- **管理画面**
  - 記事のCRUD操作
  - メディアファイル管理
  - アクセス統計表示

## 11. 技術的課題と解決策

### 11.1 課題
- **Markdownの動的読み込み**
  - 解決策：静的HTMLファイルの事前生成
  - 将来：Client-side Markdownパーサー

- **検索機能の制限**
  - 解決策：クライアントサイドでの全文検索
  - 将来：Elasticsearch / Algolia導入

### 11.2 技術的制約
- **サーバーサイド処理なし**
  - 制約：動的コンテンツ生成不可
  - 対策：静的サイト生成 + API連携

- **データベースなし**
  - 制約：永続化データの制限
  - 対策：JSONファイル + 将来的API導入

## 12. 開発ガイドライン

### 12.1 コーディング規約
- **HTML**
  - セマンティックタグの使用
  - 適切なインデント（2スペース）
  - アクセシビリティ属性の追加

- **CSS**
  - BEM命名規則
  - モバイルファースト設計
  - CSS変数の活用

- **JavaScript**
  - ES6+ 構文の使用
  - クラスベースの設計
  - 関数型プログラミング要素

### 12.2 テスト方針
- **現在**：手動テスト
- **将来**：自動テストの導入
  - Jest による単体テスト
  - Cypress による E2E テスト

## 13. 承認・レビュー

- **設計完了日**：2024年1月9日
- **設計者**：Claude Code
- **レビュー者**：プロジェクトオーナー
- **次フェーズ**：技術仕様書作成